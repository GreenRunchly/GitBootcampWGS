<?- include('./parts/head', {
    title:'Kelas', navstatus:'kelas'
}); ?>
<!-- Start Main --><main><div class="content">
<header class="banner">
    <div class="title">
        <h1><span class="dashboardSay"></span></h1>
        <h3><span class="dashboardSayDesc"></span></h3>
    </div>
</header>
<div class="blok-list flex tiles tiles-s2">
    <a class="banner hoverable small list-item" href="/pengaturan">
        <div class="title">
            <h2><i class="fas fa-user-cog"></i>Pengaturan Akun</h2>
            <p>Atur data diri mu dengan sebenar-benarnya!</p>
        </div>
    </a>
    <a class="banner hoverable small list-item" href="/rewards">
        <div class="title">
            <h2><i class="fas fa-stars"></i>Reward</h2>
            <p>Belum ada informasi terbaru, cek lagi nanti.</p>
        </div>
    </a>
</div>
<br><h2>Kelas Mengajar</h2>
<div class="blok-list kelasCreatedListing">
    <a class="banner hoverable small list-item ghost" onclick="modalShow('createKelas');">
        <div class="title">
            <h3><i class="far fa-question"></i>Tidak ada..</h3>
            <p>Buat kelas mu sendiri, dan ajar peserta mu!</p>
        </div>
    </a>
</div>
<br><h2>Kelas Undangan</h2>
<div class="blok-list kelasJoinedListing">
    <a class="banner hoverable small list-item ghost" onclick="modalShow('joinKelas');">
        <div class="title">
            <h3><i class="far fa-question"></i>Belum Join..</h3>
            <p>Join kelas sesorang untuk memulai!</p>
        </div>
    </a>
</div>
</div></main> <!-- End of Main -->

<!-- Account Handler -->
<?- include('./parts/module-akun'); ?>
<script>
    var DataPage = {};
    function loadPageInitial() {

        // Mendapat sapaan berdasarkan waktu
        let curHr = new Date().getHours(); let say = ``;
        if (curHr < 12) {
            say = `<i class="fas fa-sun-haze"></i>Good Morning`;
            sayDesc = `Minum secangkir kopi untuk memulai hari mu!`;
        } else if (curHr < 18) {
            say = `<i class="fas fa-sun"></i>Good Afternoon`;
            sayDesc = `Tetap semangat, walau terik matahari!`;
        } else {
            say = `<i class="fas fa-cloud-moon"></i>Good Evening`;
            sayDesc = `Beristirahat lah hari ini, agar siap untuk esok hari!`;
        }
        $(".dashboardSay").html(say);
        $(".dashboardSayDesc").html(sayDesc);
        
        // Load Data Kelas Joined
        $.ajax({
            type: "GET",
            url: '/api/kelas/saya',
            cache: false,
            success: function(data) {
                if (data.sukses) {
                    DataAkun.kelas_joined = data.hasil;
                    loadPageData();
                    //notifAdd('Berhasil Mengambil Data (Kelas)!', data.pesan, 'ok', 0, true, false);
                }else{
                    if (data.logout){
                        window.location.reload(); return;
                    }
                    notifAdd('Gagal Mengambil Data (Kelas)!', data.pesan, 'error', 0, false, true);
                }
            },
            error: function(xhr, status, error) {
                notifAdd('Gagal Mengambil Data (Kelas)!', `${error} (${status} / ${status})`, 'error', 0, true, true);
            }
        });

        // Eksekusi jika data berhasil didapatkan
        async function loadPageData() {
            if (DataAkun.kelas_joined){
                let dataArray = DataAkun.kelas_joined;
                $(`.kelasJoinedListing .list-item`).not(':last').remove();
                $(`.kelasCreatedListing .list-item`).not(':last').remove();
                dataArray.forEach(element => {
                    // Strukcture
                    let html = `
                        <a class="banner hoverable small list-item" href="/kelas/${element.id}">
                            <div class="title">
                                <h3><i class="far fa-chalkboard-teacher"></i>${element.class_name}</h3>
                                <h4><span>${element.room}</span> - <span>${element.subject}</span></h4>
                                <p>${element.class_desc}</p>
                            </div>
                        </a>
                    `;
                    if (element.id_owner == DataAkun.id){
                        $(`.kelasCreatedListing`).prepend(html);
                    }else{
                        $(`.kelasJoinedListing`).prepend(html);
                    }
                });
            };
        }; 
    };
</script>
<!-- Join Kelas -->
<?- include('./parts/dialog/create-class'); ?>
<!-- Create Kelas -->
<?- include('./parts/dialog/join-class'); ?>
<!-- Account Handler End -->
<?- include('./parts/footer'); ?>
